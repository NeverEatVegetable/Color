{"version":3,"sources":["file:///E:/CocosProjects/Color/assets/ts-gameframework-master/tsgf-sdk/test/unitTest/GroupRoom.test.ts"],"names":["initGame","assert","ERoomMsgRecvType","delay","MatcherKeys","logger","ErrorCodes","describe","test","initRet1","ok","succ","err","z1SDK","data","initRet2","z2SDK","initRet3","z3SDK","gMsgCount","rMsgCount","gJoinCount","rJoinCount","gLeaveCount","rLeaveCount","group","events","onRecvGroupMsg","msg","room","onRecvRoomMsg","onJoinGroup","onJoinRoom","onLeaveGroup","onLeaveRoom","gPJoin","rPJoin","gPLeave","rPLeave","onPlayerJoinGroup","onPlayerJoinRoom","onPlayerLeaveGroup","onPlayerLeaveRoom","gDismiss","rDismiss","onDismissGroupRoom","onDismissRoom","cRet","createGroup","joinRet","joinGroup","sendRet","sendGroupMsg","recvType","ROOM_ALL","sendRoomMsg","ROOM_OTHERS","ROOM_SOME","recvPlayerList","game","__myPlayerId","leaveRet","leaveGroup","dismissRet","dismissGroup","createRoomRet","createRoom","isPrivate","roomName","maxPlayers","ownerPlayerId","joinRoomRet","joinRoom","roomId","code","RoomNotIn","dispose","startM","cancelM","onGroupMatchStart","onGroupMatchResult","errMsg","errCode","ret","MatchRequestCancelled","reqMatchRet","requestMatch","matchType","matcherKey","Single","matcherParams","minPlayers","cancelRet","cancelMatch","msgCount","onGroupMatchEnterRoom","error","currGroupRoom","currRoomInfo","backRet","backGroup"],"mappings":"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","sourcesContent":["\n\nimport './Env';\nimport { initGame } from \"./TestUnit\";\nimport { assert } from 'chai';\nimport { ERoomMsgRecvType, IRecvRoomMsg } from '../../src/tsgf/room/IRoomMsg';\nimport { delay } from '../../src/tsgf/Utils';\nimport { ISingleMatcherParams, MatcherKeys } from '../../src/tsgf/match/Models';\nimport { logger } from '../../src/tsgf/logger';\nimport { ErrorCodes } from '../../src/tsgf/Result';\n\n\ndescribe(\"组队房间\", () => {\n\n    test('3个玩家组队发消息', async function () {\n\n        let initRet1 = await initGame('3个玩家组队发消息_z1', 'z1');\n        assert.ok(initRet1.succ, initRet1.err);\n        let z1SDK = initRet1.data!;\n        let initRet2 = await initGame('3个玩家组队发消息_z2', 'z2');\n        assert.ok(initRet2.succ, initRet2.err);\n        let z2SDK = initRet2.data!;\n        let initRet3 = await initGame('3个玩家组队发消息_z3', 'z3');\n        assert.ok(initRet3.succ, initRet3.err);\n        let z3SDK = initRet3.data!;\n\n        let gMsgCount = 0, rMsgCount = 0, gJoinCount = 0, rJoinCount = 0, gLeaveCount = 0, rLeaveCount = 0;\n        z1SDK.group.events.onRecvGroupMsg(msg => gMsgCount++);\n        z2SDK.group.events.onRecvGroupMsg(msg => gMsgCount++);\n        z3SDK.group.events.onRecvGroupMsg(msg => gMsgCount++);\n        z1SDK.room.events.onRecvRoomMsg(msg => rMsgCount++);\n        z2SDK.room.events.onRecvRoomMsg(msg => rMsgCount++);\n        z3SDK.room.events.onRecvRoomMsg(msg => rMsgCount++);\n\n        z1SDK.group.events.onJoinGroup(msg => gJoinCount++);\n        z2SDK.group.events.onJoinGroup(msg => gJoinCount++);\n        z3SDK.group.events.onJoinGroup(msg => gJoinCount++);\n        z1SDK.room.events.onJoinRoom(msg => rJoinCount++);\n        z2SDK.room.events.onJoinRoom(msg => rJoinCount++);\n        z3SDK.room.events.onJoinRoom(msg => rJoinCount++);\n\n        z1SDK.group.events.onLeaveGroup(msg => gLeaveCount++);\n        z2SDK.group.events.onLeaveGroup(msg => gLeaveCount++);\n        z3SDK.group.events.onLeaveGroup(msg => gLeaveCount++);\n        z1SDK.room.events.onLeaveRoom(msg => rLeaveCount++);\n        z2SDK.room.events.onLeaveRoom(msg => rLeaveCount++);\n        z3SDK.room.events.onLeaveRoom(msg => rLeaveCount++);\n\n        let gPJoin = 0, rPJoin = 0, gPLeave = 0, rPLeave = 0;\n        z1SDK.group.events.onPlayerJoinGroup(msg => gPJoin++);\n        z2SDK.group.events.onPlayerJoinGroup(msg => gPJoin++);\n        z3SDK.group.events.onPlayerJoinGroup(msg => gPJoin++);\n        z1SDK.room.events.onPlayerJoinRoom(msg => rPJoin++);\n        z2SDK.room.events.onPlayerJoinRoom(msg => rPJoin++);\n        z3SDK.room.events.onPlayerJoinRoom(msg => rPJoin++);\n\n        z1SDK.group.events.onPlayerLeaveGroup(msg => gPLeave++);\n        z2SDK.group.events.onPlayerLeaveGroup(msg => gPLeave++);\n        z3SDK.group.events.onPlayerLeaveGroup(msg => gPLeave++);\n        z1SDK.room.events.onPlayerLeaveRoom(msg => rPLeave++);\n        z2SDK.room.events.onPlayerLeaveRoom(msg => rPLeave++);\n        z3SDK.room.events.onPlayerLeaveRoom(msg => rPLeave++);\n\n        let gDismiss = 0, rDismiss = 0;\n        z1SDK.group.events.onDismissGroupRoom(msg => gDismiss++);\n        z2SDK.group.events.onDismissGroupRoom(msg => gDismiss++);\n        z3SDK.group.events.onDismissGroupRoom(msg => gDismiss++);\n        z1SDK.room.events.onDismissRoom(msg => rDismiss++);\n        z2SDK.room.events.onDismissRoom(msg => rDismiss++);\n        z3SDK.room.events.onDismissRoom(msg => rDismiss++);\n\n        gMsgCount = 0, rMsgCount = 0, gJoinCount = 0, rJoinCount = 0, gLeaveCount = 0, rLeaveCount = 0;\n        let cRet = await z1SDK.group.createGroup({});\n        assert.ok(cRet.succ, cRet.err);\n        await delay(50);\n        assert.ok(gJoinCount === 1, `玩家创建组队,应该收到1条消息, 实际为${gJoinCount},${rJoinCount}`);\n        assert.ok(rJoinCount === 0, `应该收到0条消息, 实际为${rJoinCount}`);\n\n        gMsgCount = 0, rMsgCount = 0, gJoinCount = 0, rJoinCount = 0, gLeaveCount = 0, rLeaveCount = 0;\n        gPJoin = 0, rPJoin = 0, gPLeave = 0, rPLeave = 0;\n        let joinRet = await z2SDK.group.joinGroup({}, cRet.data!);\n        assert.ok(joinRet.succ, joinRet.err);\n        await delay(50);\n        assert.ok(gJoinCount === 1, `玩家2加入组队后,应该收到1条消息, 实际为${gJoinCount}`);\n        assert.ok(rJoinCount === 0, `应该收到0条消息, 实际为${rJoinCount}`);\n        assert.ok(gPJoin === 1, `应该收到1条消息, 实际为${gPJoin}`);\n        assert.ok(rPJoin === 0, `应该收到0条消息, 实际为${rPJoin}`);\n\n        gMsgCount = 0, rMsgCount = 0, gJoinCount = 0, rJoinCount = 0, gLeaveCount = 0, rLeaveCount = 0;\n        let sendRet = await z1SDK.group.sendGroupMsg({\n            recvType: ERoomMsgRecvType.ROOM_ALL,\n            msg: 'test'\n        });\n        assert.ok(sendRet.succ, sendRet.err);\n        await delay(100);\n        assert.ok(gMsgCount === 2, `应该收到2条自定义消息, 实际为${gMsgCount}`);\n        assert.ok(rMsgCount === 0, `应该收到0条消息, 实际为${rMsgCount}`);\n\n        gMsgCount = rMsgCount = 0;\n        sendRet = await z1SDK.room.sendRoomMsg({\n            recvType: ERoomMsgRecvType.ROOM_ALL,\n            msg: 'test'\n        });\n        assert.ok(sendRet.succ, sendRet.err);\n        await delay(100);\n        assert.ok(gMsgCount === 2, `应该收到2条消息, 实际为${gMsgCount}`);\n        assert.ok(rMsgCount === 0, `应该收到0条消息, 实际为${rMsgCount}`);\n\n        gMsgCount = 0, rMsgCount = 0, gJoinCount = 0, rJoinCount = 0, gLeaveCount = 0, rLeaveCount = 0;\n        gPJoin = 0, rPJoin = 0, gPLeave = 0, rPLeave = 0;\n        joinRet = await z3SDK.group.joinGroup({}, cRet.data!);\n        assert.ok(joinRet.succ, joinRet.err);\n        assert.ok(gJoinCount === 1, `应该收到1条消息, 实际为${gJoinCount}`);\n        assert.ok(rJoinCount === 0, `应该收到0条消息, 实际为${rJoinCount}`);\n        assert.ok(gPJoin === 2, `应该收到2条消息, 实际为${gPJoin}`);\n        assert.ok(rPJoin === 0, `应该收到0条消息, 实际为${rPJoin}`);\n\n        gMsgCount = rMsgCount = 0;\n        sendRet = await z1SDK.group.sendGroupMsg({\n            recvType: ERoomMsgRecvType.ROOM_ALL,\n            msg: 'test'\n        });\n        assert.ok(sendRet.succ, sendRet.err);\n        await delay(100);\n        assert.ok(gMsgCount === 3, `应该收到3条消息, 实际为${gMsgCount}`);\n        assert.ok(rMsgCount === 0, `应该收到0条消息, 实际为${rMsgCount}`);\n\n        gMsgCount = rMsgCount = 0;\n        sendRet = await z1SDK.group.sendGroupMsg({\n            recvType: ERoomMsgRecvType.ROOM_OTHERS,\n            msg: 'test'\n        });\n        assert.ok(sendRet.succ, sendRet.err);\n        await delay(50);\n        assert.ok(gMsgCount === 2, `应该收到2条消息, 实际为${gMsgCount}`);\n        assert.ok(rMsgCount === 0, `应该收到0条消息, 实际为${rMsgCount}`);\n\n        gMsgCount = rMsgCount = 0;\n        sendRet = await z1SDK.group.sendGroupMsg({\n            recvType: ERoomMsgRecvType.ROOM_SOME,\n            recvPlayerList: [z2SDK.game.__myPlayerId],\n            msg: 'test'\n        });\n        assert.ok(sendRet.succ, sendRet.err);\n        await delay(50);\n        assert.ok(gMsgCount === 1, `应该收到1条消息, 实际为${gMsgCount}`);\n        assert.ok(rMsgCount === 0, `应该收到0条消息, 实际为${rMsgCount}`);\n\n        gLeaveCount = 0, rLeaveCount = 0;\n\n        gPLeave = 0, rPLeave = 0;\n        let leaveRet = await z2SDK.group.leaveGroup();\n        assert.ok(leaveRet.succ, leaveRet.err);\n        await delay(50);\n        assert.ok(gPLeave === 2, `应该收到2条消息, 实际为${gPLeave}`);\n        assert.ok(rPLeave === 0, `应该收到0条消息, 实际为${rPLeave}`);\n\n        gDismiss = 0, rDismiss = 0;\n        let dismissRet = await z1SDK.group.dismissGroup();\n        assert.ok(dismissRet.succ, dismissRet.err);\n        await delay(50);\n        assert.ok(gDismiss === 1, `应该收到1条消息, 实际为${gDismiss}`);\n        assert.ok(rDismiss === 0, `应该收到0条消息, 实际为${rDismiss}`);\n        assert.ok(gLeaveCount === 3, `应该收到3条消息, 实际为${gLeaveCount}`);\n        assert.ok(rLeaveCount === 0, `应该收到0条消息, 实际为${rLeaveCount}`);\n\n        //下面进房间再测试一次\n        gJoinCount = 0, rJoinCount = 0;\n        gPJoin = 0, rPJoin = 0;\n        let createRoomRet = await z1SDK.room.createRoom({}, {\n            isPrivate: true,\n            roomName: 'test',\n            maxPlayers: 3,\n            ownerPlayerId: z1SDK.game.__myPlayerId,\n        });\n        assert.ok(createRoomRet.succ, createRoomRet.err);\n\n        let joinRoomRet = await z2SDK.room.joinRoom({}, { roomId: createRoomRet.data!.roomId });\n        assert.ok(joinRoomRet.succ, joinRoomRet.err);\n        joinRoomRet = await z3SDK.room.joinRoom({}, { roomId: createRoomRet.data!.roomId });\n        assert.ok(joinRoomRet.succ, joinRoomRet.err);\n        assert.ok(gPJoin === 0, `应该收到0条消息, 实际为${gPJoin}`);\n        assert.ok(rPJoin === 3, `应该收到1+2条消息, 实际为${rPJoin}`);\n\n        sendRet = await z1SDK.group.sendGroupMsg({\n            recvType: ERoomMsgRecvType.ROOM_ALL,\n            msg: 'test'\n        });\n        assert.ok(sendRet.code === ErrorCodes.RoomNotIn, '应该提示不在组队房间!');\n\n        gMsgCount = rMsgCount = 0;\n        sendRet = await z1SDK.room.sendRoomMsg({\n            recvType: ERoomMsgRecvType.ROOM_ALL,\n            msg: 'test'\n        });\n        assert.ok(sendRet.succ, sendRet.err);\n        await delay(50);\n        assert.ok(gMsgCount === 0, `应该收到0条消息, 实际为${gMsgCount}`);\n        assert.ok(rMsgCount === 3, `应该收到3条消息, 实际为${rMsgCount}`);\n\n        await z1SDK.dispose();\n        await z2SDK.dispose();\n        await z3SDK.dispose();\n\n    }, 600000);\n\n    test('3个玩家组队匹配进房间后再回到组队', async function () {\n\n        let initRet1 = await initGame('3个玩家组队匹配进房间后再回到组队_z1', 'z1');\n        assert.ok(initRet1.succ, initRet1.err);\n        let z1SDK = initRet1.data!;\n        let initRet2 = await initGame('3个玩家组队匹配进房间后再回到组队_z2', 'z2');\n        assert.ok(initRet2.succ, initRet2.err);\n        let z2SDK = initRet2.data!;\n        let initRet3 = await initGame('3个玩家组队匹配进房间后再回到组队_z3', 'z3');\n        assert.ok(initRet3.succ, initRet3.err);\n        let z3SDK = initRet3.data!;\n\n        let cRet = await z1SDK.group.createGroup({});\n        assert.ok(cRet.succ, cRet.err);\n        let joinRet = await z2SDK.group.joinGroup({}, cRet.data!);\n        assert.ok(joinRet.succ, joinRet.err);\n        joinRet = await z3SDK.group.joinGroup({}, cRet.data!);\n        assert.ok(joinRet.succ, joinRet.err);\n\n\n        let startM = 0, cancelM = 0;\n        z1SDK.group.events.onGroupMatchStart(() => startM++);\n        z2SDK.group.events.onGroupMatchStart(() => startM++);\n        z3SDK.group.events.onGroupMatchStart(() => startM++);\n        z1SDK.group.events.onGroupMatchResult((errMsg, errCode, ret) => {\n            if (errCode === ErrorCodes.MatchRequestCancelled) cancelM++;\n        });\n        z2SDK.group.events.onGroupMatchResult((errMsg, errCode, ret) => {\n            if (errCode === ErrorCodes.MatchRequestCancelled) cancelM++;\n        });\n        z3SDK.group.events.onGroupMatchResult((errMsg, errCode, ret) => {\n            if (errCode === ErrorCodes.MatchRequestCancelled) cancelM++;\n        });\n\n        let reqMatchRet = await z1SDK.group.requestMatch({\n            matchType: 'test_请求一个暂时不会有结果的,用来测试取消',\n            matcherKey: MatcherKeys.Single,\n            matcherParams: {\n                minPlayers: 4\n            } as ISingleMatcherParams,\n            maxPlayers: 4,\n        });\n        assert.ok(reqMatchRet.succ, reqMatchRet.err);\n        await delay(500);\n        assert.ok(startM === 3, `应该收到3条消息, 实际为${startM}`);\n\n        let cancelRet = await z1SDK.group.cancelMatch();\n        assert.ok(cancelRet.succ, cancelRet.err);\n        await delay(500);\n        assert.ok(cancelM === 3, `应该收到3条消息, 实际为${cancelM}`);\n\n        let msgCount = 0;\n        z1SDK.group.events.onGroupMatchEnterRoom(ret => {\n            if (ret.succ) msgCount++;\n            else logger.error('z1进入匹配房间失败:', ret);\n        });\n        z2SDK.group.events.onGroupMatchEnterRoom(ret => {\n            if (ret.succ) msgCount++;\n            else logger.error('z2进入匹配房间失败:', ret);\n        });\n        z3SDK.group.events.onGroupMatchEnterRoom(ret => {\n            if (ret.succ) msgCount++;\n            else logger.error('z3进入匹配房间失败:', ret);\n        });\n\n        reqMatchRet = await z1SDK.group.requestMatch({\n            matchType: 'test_3个玩家组队匹配进房间后再回到组队',\n            matcherKey: MatcherKeys.Single,\n            matcherParams: {\n                minPlayers: 3\n            } as ISingleMatcherParams,\n            maxPlayers: 3,\n        });\n        assert.ok(reqMatchRet.succ, reqMatchRet.err);\n        await delay(500);\n        assert.ok(msgCount === 3, `应该收到3条消息, 实际为${msgCount}`);\n        assert.ok(z1SDK.group.currGroupRoom === null, `应该不在组队房间中了!实际还在`);\n        assert.ok(z2SDK.group.currGroupRoom === null, `应该不在组队房间中了!实际还在`);\n        assert.ok(z3SDK.group.currGroupRoom === null, `应该不在组队房间中了!实际还在`);\n        assert.ok(z1SDK.room.currRoomInfo !== null, `应该在匹配房间中了!实际不在`);\n        assert.ok(z2SDK.room.currRoomInfo !== null, `应该在匹配房间中了!实际不在`);\n        assert.ok(z3SDK.room.currRoomInfo !== null, `应该在匹配房间中了!实际不在`);\n\n        await delay(200);\n\n        let backRet = await z1SDK.group.backGroup();\n        assert.ok(backRet.succ, backRet.err);\n        backRet = await z2SDK.group.backGroup();\n        assert.ok(backRet.succ, backRet.err);\n        backRet = await z3SDK.group.backGroup();\n        assert.ok(backRet.succ, backRet.err);\n        assert.ok(z1SDK.group.currGroupRoom !== null, `应该在组队房间中了!实际不在`);\n        assert.ok(z2SDK.group.currGroupRoom !== null, `应该在组队房间中了!实际不在`);\n        assert.ok(z3SDK.group.currGroupRoom !== null, `应该在组队房间中了!实际不在`);\n\n\n        await z1SDK.dispose();\n        await z2SDK.dispose();\n        await z3SDK.dispose();\n\n    }, 600000);\n\n\n});"]}