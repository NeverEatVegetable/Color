{"version":3,"sources":["file:///E:/CocosProjects/Color/assets/ts-gameframework-master/servers/src/gameServer/api/ApiRequestAfterFrames.ts"],"names":["ApiRequestAfterFrames","call","gameServer","getGameServer","gameRoom","roomMgr","getGameRoom","conn","currPlayer","error","code","RoomNotIn","game","inSync","RoomNotInSync","afterFrames","buildAfterFrames","req","startFrameIndex","succ","ErrorCodes"],"mappings":";;;;;;;;;WAKsBA,qB;;;;;+CAAf,WAAqCC,IAArC,EAAsG;AAEzG,UAAIC,UAAU,GAAGD,IAAI,CAACE,aAAL,EAAjB;AACA,UAAIC,QAAQ,SAASF,UAAU,CAACG,OAAX,CAAmBC,WAAnB,CAA+BL,IAAI,CAACM,IAAL,CAAUC,UAAzC,CAArB;;AACA,UAAI,CAACJ,QAAL,EAAe;AACX,qBAAaH,IAAI,CAACQ,KAAL,CAAW,UAAX,EAAuB;AAAEC,UAAAA,IAAI,EAAE;AAAA;AAAA,wCAAWC;AAAnB,SAAvB,CAAb;AACH;;AACD,UAAG,CAACP,QAAQ,CAACQ,IAAT,CAAcC,MAAlB,EAAyB;AACrB,qBAAaZ,IAAI,CAACQ,KAAL,CAAW,UAAX,EAAuB;AAAEC,UAAAA,IAAI,EAAE;AAAA;AAAA,wCAAWI;AAAnB,SAAvB,CAAb;AACH;;AACD,UAAIC,WAAW,GAAGX,QAAQ,CAACQ,IAAT,CAAcI,gBAAd,CAA+Bf,IAAI,CAACgB,GAAL,CAASC,eAAxC,CAAlB;AACA,mBAAajB,IAAI,CAACkB,IAAL,CAAUJ,WAAV,CAAb;AACH,K;;;;;;;;;;;;;;;;;;;;mCAZqBf,qB;;;;;;;;AAHboB,MAAAA,U,iBAAAA,U","sourcesContent":["\nimport { ReqRequestAfterFrames, ResRequestAfterFrames } from \"../../shared/gameClient/protocols/PtlRequestAfterFrames\";\nimport { ErrorCodes } from \"../../shared/tsgf/Result\";\nimport { GameApiCall } from \"../GameServer\";\n\nexport async function ApiRequestAfterFrames(call: GameApiCall<ReqRequestAfterFrames, ResRequestAfterFrames>) {\n    \n    let gameServer = call.getGameServer();\n    let gameRoom = await gameServer.roomMgr.getGameRoom(call.conn.currPlayer);\n    if (!gameRoom) {\n        return await call.error('玩家不在房间中！', { code: ErrorCodes.RoomNotIn });\n    }\n    if(!gameRoom.game.inSync){\n        return await call.error('当前不在同步中！', { code: ErrorCodes.RoomNotInSync });\n    }\n    let afterFrames = gameRoom.game.buildAfterFrames(call.req.startFrameIndex);\n    return await call.succ(afterFrames);\n}"]}