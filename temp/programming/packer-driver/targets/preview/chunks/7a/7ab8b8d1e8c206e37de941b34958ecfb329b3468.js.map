{"version":3,"sources":["file:///E:/CocosProjects/Color/assets/ts-gameframework-master/servers/src/gameServerCluster/api/ApiTerminalDismissRoom.ts"],"names":["call","regInfo","getGameClusterServer","roomMgr","dismissRoom","req","roomId","error","code","RoomNotFound","ret","notifyGameServerDismissRoom","succ","err","roomOnlineInfo","buildRoomOnlineInfo","ErrorCodes"],"mappings":";;;;;;;;;;6BAIe,WAAgBA,IAAhB,EAA0F;AACrG;AACA,UAAIC,OAAO,GAAGD,IAAI,CAACE,oBAAL,GAA4BC,OAA5B,CAAoCC,WAApC,CAAgDJ,IAAI,CAACK,GAAL,CAASC,MAAzD,CAAd;;AACA,UAAI,CAACL,OAAL,EAAc;AACV,qBAAaD,IAAI,CAACO,KAAL,CAAW,WAAX,EAAwB;AAAEC,UAAAA,IAAI,EAAE;AAAA;AAAA,wCAAWC;AAAnB,SAAxB,CAAb;AACH,OALoG,CAMrG;;;AACA,UAAIC,GAAG,SAASV,IAAI,CAACE,oBAAL,GAA4BS,2BAA5B,CAAwDV,OAAxD,CAAhB;;AACA,UAAI,CAACS,GAAG,CAACE,IAAT,EAAe;AACX,qBAAaZ,IAAI,CAACO,KAAL,CAAWG,GAAG,CAACG,GAAf,EAAoB;AAAEL,UAAAA,IAAI,EAAEE,GAAG,CAACF;AAAZ,SAApB,CAAb;AACH,OAVoG,CAWrG;;;AACA,UAAIM,cAAc,GAAGd,IAAI,CAACE,oBAAL,GAA4Ba,mBAA5B,CAAgDd,OAAhD,CAArB;;AACA,UAAI,CAACa,cAAL,EAAqB;AACjB,qBAAad,IAAI,CAACO,KAAL,CAAW,WAAX,EAAwB;AAAEC,UAAAA,IAAI,EAAE;AAAA;AAAA,wCAAWC;AAAnB,SAAxB,CAAb;AACH;;AACD,mBAAaT,IAAI,CAACY,IAAL,CAAU;AACnBE,QAAAA;AADmB,OAAV,CAAb;AAGH,K;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAvBQE,MAAAA,U,iBAAAA,U","sourcesContent":["import { ErrorCodes } from \"../../shared/tsgf/Result\";\nimport { ReqTerminalDismissRoom, ResTerminalDismissRoom } from \"../../shared/tsgfServer/gameCluster/protocols/PtlTerminalDismissRoom\";\nimport { GameClusterApiCall } from \"../GameServerClusterMgr\";\n\nexport default async function (call: GameClusterApiCall<ReqTerminalDismissRoom, ResTerminalDismissRoom>) {\n    // 直接解散集群内的房间信息，再通知游戏服务器（游戏服务器还会再通知回来，返回了找不到的错误，游戏服务器可以忽略）\n    let regInfo = call.getGameClusterServer().roomMgr.dismissRoom(call.req.roomId);\n    if (!regInfo) {\n        return await call.error('roomId未找到', { code: ErrorCodes.RoomNotFound });\n    }\n    // 通知游戏服务器解散()\n    let ret = await call.getGameClusterServer().notifyGameServerDismissRoom(regInfo);\n    if (!ret.succ) {\n        return await call.error(ret.err, { code: ret.code });\n    }\n    // 生成房间在线信息\n    let roomOnlineInfo = call.getGameClusterServer().buildRoomOnlineInfo(regInfo);\n    if (!roomOnlineInfo) {\n        return await call.error('roomId未找到', { code: ErrorCodes.RoomNotFound });\n    }\n    return await call.succ({\n        roomOnlineInfo,\n    });\n}"]}