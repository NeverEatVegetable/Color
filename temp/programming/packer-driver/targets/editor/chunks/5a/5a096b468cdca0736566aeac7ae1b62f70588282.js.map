{"version":3,"sources":["file:///E:/CocosProjects/Color/assets/ts-gameframework-master/servers/src/gameServer/api/ApiRequestAfterFrames.ts"],"names":["ApiRequestAfterFrames","call","gameServer","getGameServer","gameRoom","roomMgr","getGameRoom","conn","currPlayer","error","code","RoomNotIn","game","inSync","RoomNotInSync","afterFrames","buildAfterFrames","req","startFrameIndex","succ","ErrorCodes"],"mappings":";;;;;AAKO,iBAAeA,qBAAf,CAAqCC,IAArC,EAAsG;AAEzG,QAAIC,UAAU,GAAGD,IAAI,CAACE,aAAL,EAAjB;AACA,QAAIC,QAAQ,GAAG,MAAMF,UAAU,CAACG,OAAX,CAAmBC,WAAnB,CAA+BL,IAAI,CAACM,IAAL,CAAUC,UAAzC,CAArB;;AACA,QAAI,CAACJ,QAAL,EAAe;AACX,aAAO,MAAMH,IAAI,CAACQ,KAAL,CAAW,UAAX,EAAuB;AAAEC,QAAAA,IAAI,EAAE;AAAA;AAAA,sCAAWC;AAAnB,OAAvB,CAAb;AACH;;AACD,QAAG,CAACP,QAAQ,CAACQ,IAAT,CAAcC,MAAlB,EAAyB;AACrB,aAAO,MAAMZ,IAAI,CAACQ,KAAL,CAAW,UAAX,EAAuB;AAAEC,QAAAA,IAAI,EAAE;AAAA;AAAA,sCAAWI;AAAnB,OAAvB,CAAb;AACH;;AACD,QAAIC,WAAW,GAAGX,QAAQ,CAACQ,IAAT,CAAcI,gBAAd,CAA+Bf,IAAI,CAACgB,GAAL,CAASC,eAAxC,CAAlB;AACA,WAAO,MAAMjB,IAAI,CAACkB,IAAL,CAAUJ,WAAV,CAAb;AACH;;;;;;;;;;;;;;;;;;mCAZqBf,qB;;;;;;;;AAHboB,MAAAA,U,iBAAAA,U","sourcesContent":["\nimport { ReqRequestAfterFrames, ResRequestAfterFrames } from \"../../shared/gameClient/protocols/PtlRequestAfterFrames\";\nimport { ErrorCodes } from \"../../shared/tsgf/Result\";\nimport { GameApiCall } from \"../GameServer\";\n\nexport async function ApiRequestAfterFrames(call: GameApiCall<ReqRequestAfterFrames, ResRequestAfterFrames>) {\n    \n    let gameServer = call.getGameServer();\n    let gameRoom = await gameServer.roomMgr.getGameRoom(call.conn.currPlayer);\n    if (!gameRoom) {\n        return await call.error('玩家不在房间中！', { code: ErrorCodes.RoomNotIn });\n    }\n    if(!gameRoom.game.inSync){\n        return await call.error('当前不在同步中！', { code: ErrorCodes.RoomNotInSync });\n    }\n    let afterFrames = gameRoom.game.buildAfterFrames(call.req.startFrameIndex);\n    return await call.succ(afterFrames);\n}"]}