{"version":3,"sources":["file:///E:/CocosProjects/Color/assets/ts-gameframework-master/servers/src/gameServer/api/ApiAuthorize.ts"],"names":["ApiAuthorize","call","ret","getGameServer","gameConnMgr","connAuthorize","conn","req","playerToken","roomWaitReconnectTime","succ","err","code","playerInfo","data","apiErrorThenClose"],"mappings":";;;;;AAKO,iBAAeA,YAAf,CAA4BC,IAA5B,EAA2E;AAC9E,QAAIC,GAAG,GAAG,MAAMD,IAAI,CAACE,aAAL,GAAqBC,WAArB,CAAiCC,aAAjC,CAA+CJ,IAAI,CAACK,IAApD,EAA0DL,IAAI,CAACM,GAAL,CAASC,WAAnE,EAAgFP,IAAI,CAACM,GAArF,EAA0FN,IAAI,CAACM,GAAL,CAASE,qBAAnG,CAAhB;;AACA,QAAI,CAACP,GAAG,CAACQ,IAAT,EAAe;AACX,aAAO,MAAM;AAAA;AAAA,kDAAkBT,IAAlB,EAAwBC,GAAG,CAACS,GAA5B,EAAiC;AAAEC,QAAAA,IAAI,EAAEV,GAAG,CAACU;AAAZ,OAAjC,CAAb;AACH;;AACD,UAAMX,IAAI,CAACS,IAAL,CAAU;AACZG,MAAAA,UAAU,EAAEX,GAAG,CAACY,IAAJ,CAASD;AADT,KAAV,CAAN;AAGH;;;;;;;;;;;;;;;;;;0BARqBb,Y;;;;;;;;AAJbe,MAAAA,iB,iBAAAA,iB","sourcesContent":["import { GameApiCall } from \"../GameServer\";\nimport { apiErrorThenClose } from \"../../shared/tsgfServer/ApiBase\";\nimport { ReqAuthorize, ResAuthorize } from \"../../shared/gameClient/protocols/PtlAuthorize\";\nimport { IPlayerInfo } from \"../../shared/tsgf/player/IPlayerInfo\";\n\nexport async function ApiAuthorize(call: GameApiCall<ReqAuthorize, ResAuthorize>) {\n    let ret = await call.getGameServer().gameConnMgr.connAuthorize(call.conn, call.req.playerToken, call.req, call.req.roomWaitReconnectTime);\n    if (!ret.succ) {\n        return await apiErrorThenClose(call, ret.err, { code: ret.code });\n    }\n    await call.succ({\n        playerInfo: ret.data.playerInfo\n    });\n}"]}